var I18nDOM=function(){"use strict";const e={childList:!0,subtree:!0},t={subtree:!0,characterData:!0};return class{constructor({attachNode:e,htmlLanguage:t,resource:s,language:a}){this.attachNode=e||document.body,this.htmlLanguage=t||document.documentElement.lang||"en",this.language=a||this.htmlLanguage,this.resource=s,this.textObserver=new MutationObserver((e=>{this.stopTextObserve(),e.forEach((e=>{this.translateTextNode(e.target,this.htmlLanguage)})),this.startTextObserve()})),this.nodeObserver=new MutationObserver((e=>{this.stopTextObserve(),e.forEach((e=>{e.addedNodes.forEach((e=>{3===e.nodeType?this.translateTextNode(e,this.htmlLanguage):this.translateNodeTree(e,this.htmlLanguage)}))})),this.startTextObserve()})),this.language!==this.htmlLanguage&&(this.startNodeObserve(),this.startNodeObserve())}startTextObserve(){this.textObserver.observe(this.attachNode,t)}stopTextObserve(){this.textObserver.disconnect()}startNodeObserve(){this.nodeObserver.observe(this.attachNode,e)}changeLanguage(e){if(this.language!==e){this.startNodeObserve(),this.startNodeObserve();const t=this.language;this.language=e,this.translateNodeTree(this.attachNode,t)}}translateNodeTree(e,t){(function(e){let t;const s=[],a=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;t=a.nextNode();)s.push(t);return s})(e).forEach((e=>{this.translateTextNode(e,t)}))}translateTextNode(e,t){const s=e.data,a=e.nextSibling;let r="";if(8===a?.nodeType){const e=a.data.match(/I18NDOM_KEY\s(.(?!I18NDOM_))+/)[0];e&&(r=` ${e}`)}const n=this.resource[t].indexOf(`${s}${r}`),h=this.resource[this.language][n];let o=h,i=null;if(o){const t=[...h.matchAll(/\sI18NDOM_([\S]+)\s((.(?!I18NDOM_))+)/g)];t.length&&(t.forEach((e=>{e[1]})),i=document.createComment(h.substring(t[0].index+1)),o=h.substring(0,t[0].index)),e.data=o}i&&(8===a?.nodeType&&a.data.includes("I18NDOM_")?a.replaceWith(i):e.after(i))}}}();
