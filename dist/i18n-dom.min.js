var I18nDOM=function(){"use strict";const e={childList:!0,subtree:!0},t={subtree:!0,characterData:!0};return class{constructor({attachNode:e,htmlLanguage:t,resource:s,language:r}){this.attachNode=e||document.body,this.htmlLanguage=t||document.documentElement.lang||"en",this.language=r||this.htmlLanguage,this.resource=s,this.textObserver=new MutationObserver((e=>{this.stopTextObserve(),e.forEach((e=>{this.translateTextNode(e.target,this.htmlLanguage)})),this.startTextObserve()})),this.nodeObserver=new MutationObserver((e=>{this.stopTextObserve(),e.forEach((e=>{e.addedNodes.forEach((e=>{3===e.nodeType?this.translateTextNode(e,this.htmlLanguage):this.translateNodeTree(e,this.htmlLanguage)}))})),this.startTextObserve()})),this.startNodeObserve(),this.startNodeObserve()}startTextObserve(){this.textObserver.observe(this.attachNode,t)}stopTextObserve(){this.textObserver.disconnect()}startNodeObserve(){this.nodeObserver.observe(this.attachNode,e)}stopNodeObserve(){this.nodeObserver.disconnect()}startObserve(){this.startTextObserve(),this.startNodeObserve()}stopObserve(){this.stopTextObserve(),this.stopNodeObserve()}changeLanguage(e){if(this.language!==e){const t=this.language;this.language=e,this.stopObserve(),this.translateNodeTree(this.attachNode,t),this.startObserve()}}translateNodeTree(e,t){(function(e){let t;const s=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null,!1);for(;t=r.nextNode();)s.push(t);return s})(e).forEach((e=>{this.translateTextNode(e,t)}))}translateTextNode(e,t){const s=e.data,r=e.nextSibling,a=8===r?.nodeType&&r.data.includes("I18NDOM_");let n=s,o=null;const h=[...s.matchAll(/\sI18NDOM_([\S]+)\s((.(?!I18NDOM_))+)/g)];if(h.length){let e="";h.forEach((t=>{let s=t[1];"DATA"===s||"KEY"===s&&(e=t[0])})),o=document.createComment(s.substring(h[0].index+1)),n=`${s.substring(0,h[0].index)}${e}`}else if(a){[...r.data.matchAll(/I18NDOM_KEY\s((.(?!I18NDOM_))+)/g)].forEach((e=>{n=`${n} ${e[0]}`}))}const i=this.resource[t].indexOf(n);let c=n;if(-1!==i){c=this.resource[this.language][i];const e=c.indexOf(" I18NDOM_");-1!==e&&(c=c.substring(0,e))}e.data=c,o&&(a?r.replaceWith(o):e.after(o))}}}();
